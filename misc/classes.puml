@startuml
skinparam packageStyle rectangle
skinparam classAttributeIconSize 0
skinparam classFontStyle bold
skinparam ArrowColor #444444
skinparam ClassBorderColor #336699
skinparam ClassBackgroundColor #EEF4FF
skinparam PackageBorderColor #336699
skinparam PackageBackgroundColor #F8FBFF
skinparam NoteBackgroundColor #FFFFF0
skinparam NoteBorderColor #AAAAAA
skinparam ClassHeaderBackgroundColor #D0E4FF
skinparam linetype curved

package "Google A2A Protocol (v0.2.5)" {

    ' ─────────────────────────────────────
    ' BASE MODEL
    ' ─────────────────────────────────────

    abstract class A2ABaseModel {
        .. Pydantic base model for all A2A types ..
        .. All protocol types inherit from this ..
    }

    ' ─────────────────────────────────────
    ' ENUMS
    ' ─────────────────────────────────────

    enum TaskState {
        .. All possible lifecycle states of a task ..
        submitted
        working
        input_required
        auth_required
        completed
        failed
        canceled
        rejected
        unknown
    }

    enum Role {
        .. Identifies who sent a message in a conversation ..
        user
        agent
    }

    enum In {
        .. Location of an API key in the HTTP request ..
        header
        query
        cookie
    }

    enum TransportType {
        .. Transport protocol used by an AgentInterface ..
        JSONRPC
        GRPC
        HTTP_JSON
    }

    ' ─────────────────────────────────────
    ' AGENT DISCOVERY: AgentCard & related
    ' ─────────────────────────────────────

    class AgentCard {
        .. Public manifest describing an agent's identity, ..
        .. capabilities, skills and security requirements. ..
        .. Published at /.well-known/agent.json ..
        + string name
        + string description
        + string url
        + string version
        + string protocolVersion = "0.2.5"
        + string iconUrl
        + string documentationUrl
        + string[] defaultInputModes
        + string[] defaultOutputModes
        + boolean supportsAuthenticatedExtendedCard
        --
        ' provider: AgentProvider (optional)
        ' capabilities: AgentCapabilities
        ' skills: AgentSkill[]
        ' securitySchemes: Map<string, SecurityScheme> (optional)
        ' security: List<Map<string, string[]>> (optional)
        ' extensions: AgentExtension[] (optional)
        ' interfaces: AgentInterface[] (optional)
    }

    note right of AgentCard
      Published at:
      /.well-known/agent.json
      (unauthenticated public card)
      Extended card may require auth.
    end note

    class AgentProvider {
        .. Organization or company that operates the agent ..
        + string organization
        + string url
    }

    class AgentCapabilities {
        .. Feature flags declaring what optional protocol ..
        .. features the agent supports ..
        + boolean streaming
        + boolean pushNotifications
        + boolean stateTransitionHistory
        --
        ' extensions: AgentExtension[] (optional)
    }

    class AgentSkill {
        .. A specific capability or function the agent can ..
        .. perform, with its supported I/O modes ..
        + string id
        + string name
        + string description
        + string[] tags
        + string[] examples (optional)
        + string[] inputModes (optional)
        + string[] outputModes (optional)
    }

    class AgentInterface {
        .. A concrete endpoint the agent exposes, ..
        .. paired with its transport protocol ..
        + string url
        --
        ' transport: TransportType
    }

    note bottom of AgentInterface
      transport values:
      "JSONRPC", "GRPC", "HTTP+JSON"
    end note

    class AgentExtension {
        .. A declared extension to the core protocol, ..
        .. identified by URI, optionally with parameters ..
        + string uri
        + string description (optional)
        + boolean required (optional)
        + Map<string, any> params (optional)
    }

    class AgentCardSignature {
        .. Cryptographic signature over the AgentCard ..
        .. to verify its authenticity and integrity ..
        + string keyId
        + string alg
        + string signature
        + string canonicalization
    }

    ' ─────────────────────────────────────
    ' TASK LIFECYCLE
    ' ─────────────────────────────────────

    class Task {
        .. The primary unit of work in A2A. Tracks state, ..
        .. message history and produced artifacts ..
        + string id
        + string contextId
        + string kind = "task"
        --
        ' status: TaskStatus
        ' history: Message[] (optional)
        ' artifacts: Artifact[] (optional)
        ' metadata: Map<string, any> (optional)
    }

    class TaskStatus {
        .. Current state of a task along with the ..
        .. agent's last status message and timestamp ..
        + string timestamp (ISO 8601, optional)
        --
        ' state: TaskState
        ' message: Message (optional — last agent message)
    }

    ' ─────────────────────────────────────
    ' MESSAGING
    ' ─────────────────────────────────────

    class Message {
        .. The basic unit of communication between a user ..
        .. and an agent, composed of one or more Parts ..
        + string messageId
        + string kind = "message"
        + string taskId (optional)
        + string contextId (optional)
        + string[] referenceTaskIds (optional)
        + string[] extensions (optional)
        + Map<string, any> metadata (optional)
        --
        ' role: Role
        ' parts: Part[]
    }

    abstract class Part {
        .. Abstract union type for message content. ..
        .. Concrete types: TextPart, FilePart, DataPart ..
        + Map<string, any> metadata (optional)
    }

    class TextPart {
        .. A plain-text segment of a message ..
        + string kind = "text"
        + string text
    }

    class FilePart {
        .. A file attachment — either inline bytes or a URI ..
        + string kind = "file"
        --
        ' file: FileWithBytes | FileWithUri
    }

    class DataPart {
        .. Structured JSON data embedded in a message, ..
        .. useful for form inputs and structured outputs ..
        + string kind = "data"
        + Map<string, any> data
    }

    class FileWithBytes {
        .. Inline file content as base64-encoded bytes ..
        + string bytes
        + string name (optional)
        + string mimeType (optional)
    }

    class FileWithUri {
        .. File referenced by a remote URI instead of ..
        .. being embedded inline ..
        + string uri
        + string name (optional)
        + string mimeType (optional)
    }

    ' ─────────────────────────────────────
    ' ARTIFACTS
    ' ─────────────────────────────────────

    class Artifact {
        .. A named output produced by a task, such as a ..
        .. generated file, report, or structured result ..
        + string artifactId
        + string name (optional)
        + string description (optional)
        + string[] extensions (optional)
        + Map<string, any> metadata (optional)
        --
        ' parts: Part[]
    }

    ' ─────────────────────────────────────
    ' STREAMING EVENTS
    ' ─────────────────────────────────────

    class TaskStatusUpdateEvent {
        .. Streamed event reporting a change in task state. ..
        .. final=true signals the stream is complete ..
        + string taskId
        + string contextId
        + string kind = "status-update"
        + boolean final
        --
        ' status: TaskStatus
        ' metadata: Map<string, any> (optional)
    }

    class TaskArtifactUpdateEvent {
        .. Streamed event delivering an artifact or chunk. ..
        .. lastChunk=true signals end of artifact stream ..
        + string taskId
        + string contextId
        + string kind = "artifact-update"
        + boolean append (optional)
        + boolean lastChunk (optional)
        --
        ' artifact: Artifact
        ' metadata: Map<string, any> (optional)
    }

    ' ─────────────────────────────────────
    ' PUSH NOTIFICATIONS
    ' ─────────────────────────────────────

    class PushNotificationConfig {
        .. Webhook configuration for the agent to push ..
        .. task updates to an external URL ..
        + string url
        + string id (optional)
        + string token (optional)
        --
        ' authentication: PushNotificationAuthenticationInfo (optional)
    }

    class PushNotificationAuthenticationInfo {
        .. Authentication details required when the agent ..
        .. calls the push notification webhook URL ..
        + string[] schemes
        + string credentials (optional)
    }

    class TaskPushNotificationConfig {
        .. Associates a push notification configuration ..
        .. with a specific task ID ..
        + string taskId
        --
        ' pushNotificationConfig: PushNotificationConfig
    }

    ' ─────────────────────────────────────
    ' SECURITY SCHEMES
    ' ─────────────────────────────────────

    abstract class SecurityScheme {
        .. Abstract base for all supported authentication ..
        .. and authorization schemes on an AgentCard ..
        + string type
        + string description (optional)
    }

    class APIKeySecurityScheme {
        .. API key passed in header, query param, or cookie ..
        + string type = "apiKey"
        + string name
        --
        ' in_: In (header | query | cookie)
    }

    class HTTPAuthSecurityScheme {
        .. Standard HTTP authentication such as Bearer ..
        .. tokens or Basic auth credentials ..
        + string type = "http"
        + string scheme
        + string bearerFormat (optional)
    }

    class OAuth2SecurityScheme {
        .. OAuth 2.0 authorization with configurable flows ..
        .. (implicit, password, client_credentials, authCode) ..
        + string type = "oauth2"
        --
        ' flows: OAuthFlows
    }

    class OpenIdConnectSecurityScheme {
        .. OpenID Connect discovery-based authentication ..
        + string type = "openIdConnect"
        + string openIdConnectUrl
    }

    class MutualTlsSecurityScheme {
        .. Mutual TLS client certificate authentication ..
        + string type = "mutualTLS"
    }

    class OAuthFlows {
        .. Container for all supported OAuth 2.0 grant flows. ..
        .. At least one flow must be defined ..
        --
        ' implicit: ImplicitOAuthFlow (optional)
        ' password: PasswordOAuthFlow (optional)
        ' clientCredentials: ClientCredentialsOAuthFlow (optional)
        ' authorizationCode: AuthorizationCodeOAuthFlow (optional)
        ' deviceCode: DeviceCodeOAuthFlow (optional)
    }

    class ImplicitOAuthFlow {
        .. OAuth 2.0 implicit grant — token returned ..
        .. directly from authorization endpoint ..
        + string authorizationUrl
        + string refreshUrl (optional)
        + Map<string, string> scopes
    }

    class PasswordOAuthFlow {
        .. OAuth 2.0 resource owner password credentials ..
        .. grant — user provides username and password ..
        + string tokenUrl
        + string refreshUrl (optional)
        + Map<string, string> scopes
    }

    class ClientCredentialsOAuthFlow {
        .. OAuth 2.0 client credentials grant — machine-to- ..
        .. machine auth without user involvement ..
        + string tokenUrl
        + string refreshUrl (optional)
        + Map<string, string> scopes
    }

    class AuthorizationCodeOAuthFlow {
        .. OAuth 2.0 authorization code grant — standard ..
        .. user-interactive login flow with redirect ..
        + string authorizationUrl
        + string tokenUrl
        + string refreshUrl (optional)
        + Map<string, string> scopes
    }

    class DeviceCodeOAuthFlow {
        .. OAuth 2.0 device authorization grant — for ..
        .. input-constrained devices (TV, CLI tools) ..
        + string deviceAuthorizationUrl
        + string tokenUrl
        + string refreshUrl (optional)
        + Map<string, string> scopes
    }

    ' ─────────────────────────────────────
    ' JSON-RPC LAYER
    ' ─────────────────────────────────────

    class JSONRPCMessage {
        .. Base class for all JSON-RPC 2.0 messages, ..
        .. shared by requests and responses ..
        + string jsonrpc = "2.0"
        + string | int id (optional)
    }

    class JSONRPCRequest {
        .. A JSON-RPC 2.0 request invoking a named ..
        .. method with optional parameters ..
        + string jsonrpc = "2.0"
        + string method
        + string | int id (optional)
        --
        ' params: object (optional)
    }

    class JSONRPCSuccessResponse {
        .. A JSON-RPC 2.0 success response containing ..
        .. the result of the invoked method ..
        + string jsonrpc = "2.0"
        + string | int id (optional)
        --
        ' result: any
    }

    class JSONRPCErrorResponse {
        .. A JSON-RPC 2.0 error response returned when ..
        .. a request cannot be fulfilled ..
        + string jsonrpc = "2.0"
        + string | int id (optional)
        --
        ' error: JSONRPCError (union of all error types)
    }

    class JSONRPCError {
        .. Base error structure with numeric code, ..
        .. message string, and optional detail data ..
        + int code
        + string message
        + any data (optional)
    }

    ' ─────────────────────────────────────
    ' ERROR TYPES — Standard JSON-RPC
    ' ─────────────────────────────────────

    class JSONParseError {
        .. Returned when the request body is not valid JSON ..
        + int code = -32700
        + string message = "Invalid JSON payload"
        + any data (optional)
    }

    class InvalidRequestError {
        .. Returned when the JSON-RPC request object fails ..
        .. schema validation ..
        + int code = -32600
        + string message = "Request payload validation error"
        + any data (optional)
    }

    class MethodNotFoundError {
        .. Returned when the requested method does not ..
        .. exist on this agent ..
        + int code = -32601
        + string message = "Method not found"
        + any data (optional)
    }

    class InvalidParamsError {
        .. Returned when method parameters are structurally ..
        .. invalid or missing required fields ..
        + int code = -32602
        + string message = "Invalid parameters"
        + any data (optional)
    }

    class InternalError {
        .. Returned when an unexpected server-side error ..
        .. occurs during request processing ..
        + int code = -32603
        + string message = "Internal error"
        + any data (optional)
    }

    ' ─────────────────────────────────────
    ' ERROR TYPES — A2A Specific
    ' ─────────────────────────────────────

    class TaskNotFoundError {
        .. The referenced task ID does not exist ..
        + int code = -32001
        + string message = "Task not found"
        + any data (optional)
    }

    class TaskNotCancelableError {
        .. The task is in a terminal state and cannot ..
        .. be canceled ..
        + int code = -32002
        + string message = "Task cannot be canceled"
        + any data (optional)
    }

    class PushNotificationNotSupportedError {
        .. This agent does not support push notifications ..
        + int code = -32003
        + string message = "Push Notification is not supported"
        + any data (optional)
    }

    class UnsupportedOperationError {
        .. The requested operation is not implemented ..
        .. by this agent ..
        + int code = -32004
        + string message = "This operation is not supported"
        + any data (optional)
    }

    class ContentTypeNotSupportedError {
        .. The client's requested content type is ..
        .. incompatible with the agent's capabilities ..
        + int code = -32005
        + string message = "Incompatible content types"
        + any data (optional)
    }

    class InvalidAgentResponseError {
        .. The agent returned a response that does not ..
        .. conform to the A2A protocol format ..
        + int code = -32006
        + string message = "Invalid agent response"
        + any data (optional)
    }

    ' ─────────────────────────────────────
    ' OPERATION PAYLOADS — Requests
    ' ─────────────────────────────────────

    class SendMessageRequest {
        .. Sends a user message to an agent synchronously. ..
        .. Returns a Task or Message when complete ..
        + string jsonrpc = "2.0"
        + string method = "message/send"
        + string | int id
        --
        ' params: MessageSendParams
    }

    class SendStreamingMessageRequest {
        .. Sends a user message and receives a stream of ..
        .. TaskStatusUpdateEvent / TaskArtifactUpdateEvent ..
        + string jsonrpc = "2.0"
        + string method = "message/stream"
        + string | int id
        --
        ' params: MessageSendParams
    }

    class MessageSendParams {
        .. Parameters for sending a message — wraps the ..
        .. message and optional send configuration ..
        + string contextId (optional)
        + Map<string, any> metadata (optional)
        --
        ' message: Message
        ' configuration: MessageSendConfiguration (optional)
    }

    class MessageSendConfiguration {
        .. Controls how the agent processes and responds ..
        .. to a message send request ..
        + string[] acceptedOutputModes
        + boolean blocking (optional)
        + int historyLength (optional)
        --
        ' pushNotificationConfig: PushNotificationConfig (optional)
    }

    class GetTaskRequest {
        .. Retrieves the current state and history of ..
        .. an existing task by its ID ..
        + string jsonrpc = "2.0"
        + string method = "tasks/get"
        + string | int id
        --
        ' params: TaskQueryParams
    }

    class TaskQueryParams {
        .. Parameters for fetching a task, with optional ..
        .. limit on how many history messages to return ..
        + string id
        + int historyLength (optional)
        + Map<string, any> metadata (optional)
    }

    class ListTasksRequest {
        .. Lists tasks, optionally filtered by context, ..
        .. status, or paginated with a page token ..
        + string jsonrpc = "2.0"
        + string method = "tasks/list"
        + string | int id
        --
        ' params: TaskListParams (optional)
    }

    class TaskListParams {
        .. Filtering and pagination parameters for ..
        .. the tasks/list method ..
        + string contextId (optional)
        + string status (optional)
        + int pageSize (optional)
        + string pageToken (optional)
        + int historyLength (optional)
    }

    class CancelTaskRequest {
        .. Requests cancellation of an in-progress task. ..
        .. Fails if task is already in a terminal state ..
        + string jsonrpc = "2.0"
        + string method = "tasks/cancel"
        + string | int id
        --
        ' params: TaskIdParams
    }

    class TaskIdParams {
        .. Minimal parameter set identifying a task by ID, ..
        .. used by cancel, resubscribe and push config ops ..
        + string id
        + Map<string, any> metadata (optional)
    }

    class ResubscribeToTaskRequest {
        .. Re-opens a streaming connection to an existing ..
        .. task to receive remaining events ..
        + string jsonrpc = "2.0"
        + string method = "tasks/resubscribe"
        + string | int id
        --
        ' params: TaskIdParams
    }

    class SetTaskPushNotificationConfigRequest {
        .. Registers or updates a webhook push notification ..
        .. configuration for a specific task ..
        + string jsonrpc = "2.0"
        + string method = "tasks/pushNotificationConfig/set"
        + string | int id
        --
        ' params: TaskPushNotificationConfig
    }

    class GetTaskPushNotificationConfigRequest {
        .. Retrieves the current push notification ..
        .. configuration for a given task ..
        + string jsonrpc = "2.0"
        + string method = "tasks/pushNotificationConfig/get"
        + string | int id
        --
        ' params: TaskIdParams
    }

    class ListTaskPushNotificationConfigRequest {
        .. Lists all push notification configurations ..
        .. registered for a given task ..
        + string jsonrpc = "2.0"
        + string method = "tasks/pushNotificationConfig/list"
        + string | int id
        --
        ' params: TaskIdParams
    }

    class DeleteTaskPushNotificationConfigRequest {
        .. Deletes a specific push notification configuration ..
        .. by its config ID, optionally scoped to a task ..
        + string jsonrpc = "2.0"
        + string method = "tasks/pushNotificationConfig/delete"
        + string | int id
        --
        ' params: PushNotificationConfigIdentifier
    }

    class PushNotificationConfigIdentifier {
        .. Uniquely identifies a push notification config, ..
        .. optionally scoped to a specific task ..
        + string id
        + string taskId (optional)
    }

    ' ─────────────────────────────────────
    ' OPERATION PAYLOADS — Responses
    ' ─────────────────────────────────────

    class SendMessageResponse {
        .. Success response to message/send. Result is a ..
        .. Task (if async) or Message (if blocking) ..
        ' result: Task | Message
    }

    class GetTaskResponse {
        .. Success response containing the full Task ..
        .. object with current status and history ..
        ' result: Task
    }

    class CancelTaskResponse {
        .. Success response confirming task cancellation, ..
        .. returning the Task in its final canceled state ..
        ' result: Task
    }

    class SetTaskPushNotificationConfigResponse {
        .. Success response returning the stored ..
        .. TaskPushNotificationConfig ..
        ' result: TaskPushNotificationConfig
    }

    class GetTaskPushNotificationConfigResponse {
        .. Success response returning the push notification ..
        .. configuration for the requested task ..
        ' result: TaskPushNotificationConfig
    }

    class ListTaskPushNotificationConfigResponse {
        .. Success response listing all push notification ..
        .. configurations registered for a task ..
        ' result: TaskPushNotificationConfig[]
    }

    ' ─────────────────────────────────────
    ' SERVICE LAYER
    ' ─────────────────────────────────────

    interface A2AServer {
        .. Server-side interface that an agent implements ..
        .. to handle all A2A protocol methods ..
        + AgentCard getAgentCard()
        + AgentCard getExtendedAgentCard()
        + Task|Message sendMessage(SendMessageRequest)
        + Stream<Event> sendStreamingMessage(SendStreamingMessageRequest)
        + Task getTask(GetTaskRequest)
        + Task[] listTasks(ListTasksRequest)
        + Task cancelTask(CancelTaskRequest)
        + Stream<Event> resubscribeToTask(ResubscribeToTaskRequest)
        + TaskPushNotificationConfig setPushNotificationConfig(SetTaskPushNotificationConfigRequest)
        + TaskPushNotificationConfig getPushNotificationConfig(GetTaskPushNotificationConfigRequest)
        + TaskPushNotificationConfig[] listPushNotificationConfigs(ListTaskPushNotificationConfigRequest)
        + void deletePushNotificationConfig(DeleteTaskPushNotificationConfigRequest)
    }

    class A2AClient {
        .. Client-side SDK used by callers to communicate ..
        .. with a remote A2A-compliant agent server ..
        + A2AClient(string agentUrl)
        + AgentCard discover()
        + Task|Message sendMessage(Message, MessageSendConfiguration)
        + Stream<Event> sendStreamingMessage(Message, MessageSendConfiguration)
        + Task getTask(string taskId, int historyLength)
        + Task[] listTasks(TaskListParams)
        + Task cancelTask(string taskId)
        + Stream<Event> resubscribeToTask(string taskId)
        + TaskPushNotificationConfig setPushNotificationConfig(string taskId, PushNotificationConfig)
        + TaskPushNotificationConfig getPushNotificationConfig(string taskId)
        + TaskPushNotificationConfig[] listPushNotificationConfigs(string taskId)
        + void deletePushNotificationConfig(string pushConfigId)
    }

    abstract class AgentExecutor {
        .. Abstract base for agent business logic. ..
        .. Implementors handle task execution and cancellation ..
        + {abstract} void execute(RequestContext, EventQueue)
        + {abstract} void cancel(RequestContext, EventQueue)
    }

    class RequestContext {
        .. Contextual information passed to AgentExecutor ..
        .. when a message or cancel request is received ..
        + string taskId
        + string contextId
        + Message message
        + Task currentTask (optional)
        + string getUserInput()
    }

    class EventQueue {
        .. Queue used by AgentExecutor to emit streaming ..
        .. status and artifact events back to the caller ..
        + void enqueueEvent(TaskStatusUpdateEvent | TaskArtifactUpdateEvent)
        + void close()
    }

    ' ─────────────────────────────────────
    ' RELATIONSHIPS
    ' ─────────────────────────────────────

    ' Base model inheritance
    A2ABaseModel <|-- AgentCard
    A2ABaseModel <|-- AgentCapabilities
    A2ABaseModel <|-- AgentSkill
    A2ABaseModel <|-- AgentProvider
    A2ABaseModel <|-- AgentInterface
    A2ABaseModel <|-- AgentExtension
    A2ABaseModel <|-- Task
    A2ABaseModel <|-- TaskStatus
    A2ABaseModel <|-- Message
    A2ABaseModel <|-- Part
    A2ABaseModel <|-- Artifact
    A2ABaseModel <|-- PushNotificationConfig
    A2ABaseModel <|-- TaskPushNotificationConfig
    A2ABaseModel <|-- SecurityScheme

    ' AgentCard composition
    AgentCard "1" *-- "1" AgentCapabilities : has
    AgentCard "1" *-- "0..1" AgentProvider : providedBy
    AgentCard "1" *-- "1..*" AgentSkill : exposes
    AgentCard "1" *-- "0..*" AgentInterface : supportsTransportVia
    AgentCard "1" *-- "0..*" AgentExtension : declares
    AgentCard "1" *-- "0..*" AgentCardSignature : signedWith
    AgentCard "1" *-- "0..*" SecurityScheme : securedBy

    ' AgentInterface uses TransportType
    AgentInterface ..> TransportType : uses

    ' APIKeySecurityScheme uses In
    APIKeySecurityScheme ..> In : location

    ' Task composition
    Task "1" *-- "1" TaskStatus : hasStatus
    Task "1" *-- "0..*" Message : history
    Task "1" *-- "0..*" Artifact : produces
    TaskStatus "1" *-- "1" TaskState : state
    TaskStatus "0..1" *-- "0..1" Message : lastAgentMessage

    ' Message composition
    Message "1" *-- "1..*" Part : consistsOf
    Message "1" -- "1" Role : sentBy

    ' Part subtypes
    Part <|-- TextPart
    Part <|-- FilePart
    Part <|-- DataPart
    FilePart "1" *-- "1" FileWithBytes : orBytes
    FilePart "1" *-- "1" FileWithUri : orUri

    ' Artifact composition
    Artifact "1" *-- "1..*" Part : madeOf

    ' Streaming events
    TaskStatusUpdateEvent "1" *-- "1" TaskStatus : carries
    TaskArtifactUpdateEvent "1" *-- "1" Artifact : carries

    ' Push notification composition
    PushNotificationConfig "1" *-- "0..1" PushNotificationAuthenticationInfo : securedBy
    TaskPushNotificationConfig "1" *-- "1" PushNotificationConfig : wraps

    ' Security scheme subtypes
    SecurityScheme <|-- APIKeySecurityScheme
    SecurityScheme <|-- HTTPAuthSecurityScheme
    SecurityScheme <|-- OAuth2SecurityScheme
    SecurityScheme <|-- OpenIdConnectSecurityScheme
    SecurityScheme <|-- MutualTlsSecurityScheme
    OAuth2SecurityScheme "1" *-- "1" OAuthFlows : defines
    OAuthFlows "0..1" *-- "0..1" ImplicitOAuthFlow : implicit
    OAuthFlows "0..1" *-- "0..1" PasswordOAuthFlow : password
    OAuthFlows "0..1" *-- "0..1" ClientCredentialsOAuthFlow : clientCredentials
    OAuthFlows "0..1" *-- "0..1" AuthorizationCodeOAuthFlow : authorizationCode
    OAuthFlows "0..1" *-- "0..1" DeviceCodeOAuthFlow : deviceCode

    ' JSON-RPC hierarchy
    JSONRPCMessage <|-- JSONRPCRequest
    JSONRPCMessage <|-- JSONRPCSuccessResponse
    JSONRPCMessage <|-- JSONRPCErrorResponse
    JSONRPCErrorResponse "1" *-- "1" JSONRPCError : containsOnError

    ' Error type hierarchy
    JSONRPCError <|-- JSONParseError
    JSONRPCError <|-- InvalidRequestError
    JSONRPCError <|-- MethodNotFoundError
    JSONRPCError <|-- InvalidParamsError
    JSONRPCError <|-- InternalError
    JSONRPCError <|-- TaskNotFoundError
    JSONRPCError <|-- TaskNotCancelableError
    JSONRPCError <|-- PushNotificationNotSupportedError
    JSONRPCError <|-- UnsupportedOperationError
    JSONRPCError <|-- ContentTypeNotSupportedError
    JSONRPCError <|-- InvalidAgentResponseError

    ' Request payloads (all extend JSONRPCRequest)
    JSONRPCRequest <|-- SendMessageRequest
    JSONRPCRequest <|-- SendStreamingMessageRequest
    JSONRPCRequest <|-- GetTaskRequest
    JSONRPCRequest <|-- ListTasksRequest
    JSONRPCRequest <|-- CancelTaskRequest
    JSONRPCRequest <|-- ResubscribeToTaskRequest
    JSONRPCRequest <|-- SetTaskPushNotificationConfigRequest
    JSONRPCRequest <|-- GetTaskPushNotificationConfigRequest
    JSONRPCRequest <|-- ListTaskPushNotificationConfigRequest
    JSONRPCRequest <|-- DeleteTaskPushNotificationConfigRequest

    ' Response payloads (all extend JSONRPCSuccessResponse)
    JSONRPCSuccessResponse <|-- SendMessageResponse
    JSONRPCSuccessResponse <|-- GetTaskResponse
    JSONRPCSuccessResponse <|-- CancelTaskResponse
    JSONRPCSuccessResponse <|-- SetTaskPushNotificationConfigResponse
    JSONRPCSuccessResponse <|-- GetTaskPushNotificationConfigResponse
    JSONRPCSuccessResponse <|-- ListTaskPushNotificationConfigResponse

    ' Request params composition
    SendMessageRequest "1" *-- "1" MessageSendParams : params
    SendStreamingMessageRequest "1" *-- "1" MessageSendParams : params
    MessageSendParams "1" *-- "1" Message : includes
    MessageSendParams "0..1" *-- "0..1" MessageSendConfiguration : configuredBy
    MessageSendConfiguration "0..1" *-- "0..1" PushNotificationConfig : notifyVia

    GetTaskRequest "1" *-- "1" TaskQueryParams : params
    ListTasksRequest "0..1" *-- "0..1" TaskListParams : params
    CancelTaskRequest "1" *-- "1" TaskIdParams : params
    ResubscribeToTaskRequest "1" *-- "1" TaskIdParams : params
    SetTaskPushNotificationConfigRequest "1" *-- "1" TaskPushNotificationConfig : params
    GetTaskPushNotificationConfigRequest "1" *-- "1" TaskIdParams : params
    ListTaskPushNotificationConfigRequest "1" *-- "1" TaskIdParams : params
    DeleteTaskPushNotificationConfigRequest "1" *-- "1" PushNotificationConfigIdentifier : params

    ' Service layer
    A2AServer ..> AgentCard : exposes
    A2AServer ..> Task : manages
    A2AServer ..> TaskStatusUpdateEvent : emits
    A2AServer ..> TaskArtifactUpdateEvent : emits
    A2AServer ..> PushNotificationConfig : manages
    A2AServer ..> AgentExecutor : delegatesTo

    A2AClient ..> SendMessageRequest : constructs
    A2AClient ..> SendStreamingMessageRequest : constructs
    A2AClient ..> Task : receives
    A2AClient ..> TaskStatusUpdateEvent : receives
    A2AClient ..> TaskArtifactUpdateEvent : receives
    A2AClient --> A2AServer : communicatesVia HTTP/JSON-RPC/gRPC

    AgentExecutor ..> RequestContext : processes
    AgentExecutor ..> EventQueue : publishesTo
    EventQueue ..> TaskStatusUpdateEvent : queues
    EventQueue ..> TaskArtifactUpdateEvent : queues
}

legend right
  |= Symbol    |= Meaning              |
  | *--        | Composition           |
  | <|--       | Inheritance/Subtype   |
  | ..>        | Dependency/Usage      |
  | -->        | Association           |
  Sources: a2aprotocol.ai spec v0.2.5,
  official Python SDK types.py,
  GitHub a2aproject/A2A
endlegend

@enduml
